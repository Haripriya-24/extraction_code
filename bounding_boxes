#bounding boxes
import cv2
import numpy as np
import matplotlib.pyplot as plt

# Load image
img = cv2.imread("pic1.jpg")
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
gray = cv2.GaussianBlur(gray, (5, 5), 0)

# Binary threshold
_, binary = cv2.threshold(gray, 0, 255, cv2.THRESH_BINARY_INV + cv2.THRESH_OTSU)

# Vertical line detection
vertical_kernel = cv2.getStructuringElement(cv2.MORPH_RECT, (1, 40))
vertical_lines = cv2.morphologyEx(binary, cv2.MORPH_OPEN, vertical_kernel, iterations=2)

# Horizontal line detection
horizontal_kernel = cv2.getStructuringElement(cv2.MORPH_RECT, (40, 1))
horizontal_lines = cv2.morphologyEx(binary, cv2.MORPH_OPEN, horizontal_kernel, iterations=2)

# Draw bounding boxes
boxed_img = img.copy()

# Vertical lines (columns)
col_contours, _ = cv2.findContours(vertical_lines, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
for c in col_contours:
    x, y, w, h = cv2.boundingRect(c)
    cv2.rectangle(boxed_img, (x, 0), (x + w, img.shape[0]), (255, 0, 0), 2)  # Blue

# Horizontal lines (rows)
row_contours, _ = cv2.findContours(horizontal_lines, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
for c in row_contours:
    x, y, w, h = cv2.boundingRect(c)
    cv2.rectangle(boxed_img, (0, y), (img.shape[1], y + h), (0, 255, 0), 2)  # Green

# Show result
plt.figure(figsize=(15, 8))
plt.imshow(cv2.cvtColor(boxed_img, cv2.COLOR_BGR2RGB))
plt.axis("off")
plt.title("Column (Blue) and Row (Green) Bounding Boxes")
plt.show()
